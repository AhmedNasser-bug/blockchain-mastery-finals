<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blockchain Mastery Speedrun</title>
    <meta name="description"
        content="Master Blockchain concepts with this interactive speedrun quiz. 120 questions, timed challenges, and progress tracking used for finals prep.">
    <meta name="theme-color" content="#0a0a0f">
    <meta property="og:title" content="Blockchain Mastery Speedrun">
    <meta property="og:description" content="Ace your blockchain finals with this high-speed quiz app.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://cdn-icons-png.flaticon.com/512/2091/2091665.png">
    <link rel="manifest" href="manifest.json">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚õìÔ∏è</text></svg>">
    <link rel="apple-touch-icon" href="icon-192.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        :root {
            --primary: #0078d4;
            --primary-dark: #106ebe;
            --primary-light: #2899f5;
            --accent: #00b7c3;
            --accent-glow: #00d4e0;
            --bg-dark: #0a0a0f;
            --bg-card: #12121a;
            --bg-hover: #1a1a25;
            --bg-input: #1e1e2a;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --text-muted: #606070;
            --success: #00c853;
            --success-glow: #00ff6a;
            --error: #ff4757;
            --error-glow: #ff6b7a;
            --warning: #ffa000;
            --border: #2a2a3a;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            --glass: rgba(255, 255, 255, 0.03);
            --radius: 12px;
            --radius-sm: 8px;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden
        }

        .glow-line {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary), var(--accent), var(--primary), transparent);
            z-index: 1000
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px
        }

        .header {
            text-align: center;
            padding: 40px 20px;
            position: relative
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-light), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            letter-spacing: -1px
        }

        .header p {
            color: var(--text-secondary);
            font-size: 1.1rem
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 30px 0
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transform: scaleX(0);
            transition: transform 0.3s
        }

        .stat-card:hover::before {
            transform: scaleX(1)
        }

        .stat-card:hover {
            border-color: var(--primary);
            transform: translateY(-2px)
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-light)
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 5px;
            text-transform: uppercase;
            letter-spacing: 1px
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 30px;
            margin: 20px 0;
            box-shadow: var(--shadow)
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 14px 32px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(0, 120, 212, 0.3)
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 120, 212, 0.4)
        }

        .btn-secondary {
            background: var(--bg-input);
            color: var(--text-primary);
            border: 1px solid var(--border)
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            background: var(--bg-hover)
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #00a045);
            color: white
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--error), #e0404f);
            color: white
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none
        }

        .btn-lg {
            padding: 18px 48px;
            font-size: 1.1rem
        }

        .timer-display {
            font-size: 3.5rem;
            font-weight: 700;
            font-family: 'Consolas', monospace;
            color: var(--accent);
            text-shadow: 0 0 30px rgba(0, 183, 195, 0.5);
            text-align: center;
            margin: 20px 0
        }

        .timer-display.warning {
            color: var(--warning);
            text-shadow: 0 0 30px rgba(255, 160, 0, 0.5)
        }

        .timer-display.danger {
            color: var(--error);
            text-shadow: 0 0 30px rgba(255, 71, 87, 0.5);
            animation: pulse 0.5s infinite
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1
            }

            50% {
                opacity: 0.7
            }
        }

        .progress-container {
            background: var(--bg-input);
            border-radius: 20px;
            height: 12px;
            overflow: hidden;
            margin: 20px 0;
            position: relative
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 20px;
            transition: width 0.5s ease;
            position: relative
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 2s infinite
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%)
            }

            100% {
                transform: translateX(100%)
            }
        }

        .progress-text {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 8px
        }

        .question-container {
            animation: fadeIn 0.4s ease
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border)
        }

        .question-number {
            font-size: 0.9rem;
            color: var(--accent);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px
        }

        .question-category {
            font-size: 0.8rem;
            color: var(--text-muted);
            padding: 6px 12px;
            background: var(--bg-input);
            border-radius: 20px
        }

        .question-text {
            font-size: 1.4rem;
            line-height: 1.6;
            margin-bottom: 30px;
            color: var(--text-primary)
        }

        .question-type {
            font-size: 0.75rem;
            color: var(--primary-light);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 12px
        }

        .option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 20px;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden
        }

        .option:hover {
            border-color: var(--primary);
            background: var(--bg-hover)
        }

        .option.selected {
            border-color: var(--primary);
            background: rgba(0, 120, 212, 0.15)
        }

        .option.correct {
            border-color: var(--success);
            background: rgba(0, 200, 83, 0.15)
        }

        .option.incorrect {
            border-color: var(--error);
            background: rgba(255, 71, 87, 0.15)
        }

        .option-marker {
            width: 28px;
            height: 28px;
            border: 2px solid var(--border);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-muted);
            transition: all 0.2s;
            flex-shrink: 0
        }

        .option.selected .option-marker {
            border-color: var(--primary);
            background: var(--primary);
            color: white
        }

        .option.correct .option-marker {
            border-color: var(--success);
            background: var(--success);
            color: white
        }

        .option.incorrect .option-marker {
            border-color: var(--error);
            background: var(--error);
            color: white
        }

        .option-text {
            flex: 1;
            font-size: 1rem;
            line-height: 1.5
        }

        .multi-select .option-marker {
            border-radius: 6px
        }

        .tf-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px
        }

        .tf-option {
            padding: 25px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600
        }

        .match-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px
        }

        .match-column h4 {
            color: var(--text-secondary);
            margin-bottom: 15px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px
        }

        .match-item {
            padding: 15px 18px;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem
        }

        .match-item:hover {
            border-color: var(--primary)
        }

        .match-item.selected {
            border-color: var(--accent);
            background: rgba(0, 183, 195, 0.15)
        }

        .match-item.matched {
            border-color: var(--success);
            background: rgba(0, 200, 83, 0.1);
            cursor: default
        }

        .match-item.matched::after {
            content: '‚úì';
            float: right;
            color: var(--success)
        }

        .order-container {
            display: flex;
            flex-direction: column;
            gap: 10px
        }

        .order-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 18px;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: grab;
            transition: all 0.2s
        }

        .order-item:hover {
            border-color: var(--primary)
        }

        .order-item.dragging {
            opacity: 0.5;
            border-color: var(--accent)
        }

        .order-item .order-num {
            width: 30px;
            height: 30px;
            background: var(--bg-card);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--primary-light);
            flex-shrink: 0
        }

        .order-item .drag-handle {
            color: var(--text-muted);
            margin-left: auto
        }

        .fill-blank {
            display: inline-flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 8px;
            line-height: 2.5
        }

        .blank-slot {
            display: inline-block;
            min-width: 150px;
            padding: 8px 15px;
            background: var(--bg-input);
            border: 2px dashed var(--border);
            border-radius: var(--radius-sm);
            text-align: center;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s
        }

        .blank-slot:hover {
            border-color: var(--primary)
        }

        .blank-slot.filled {
            border-style: solid;
            border-color: var(--primary);
            color: var(--text-primary);
            background: rgba(0, 120, 212, 0.1)
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            padding: 20px;
            background: var(--bg-input);
            border-radius: var(--radius);
            border: 1px solid var(--border)
        }

        .word-chip {
            padding: 10px 18px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.95rem
        }

        .word-chip:hover {
            border-color: var(--primary);
            background: var(--bg-hover)
        }

        .word-chip.used {
            opacity: 0.4;
            cursor: not-allowed
        }

        .action-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border)
        }

        .feedback {
            padding: 20px;
            border-radius: var(--radius-sm);
            margin-top: 20px;
            display: none
        }

        .feedback.correct {
            display: block;
            background: rgba(0, 200, 83, 0.1);
            border: 1px solid var(--success)
        }

        .feedback.incorrect {
            display: block;
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid var(--error)
        }

        .feedback-icon {
            font-size: 1.5rem;
            margin-right: 10px
        }

        .results-container {
            text-align: center
        }

        .results-score {
            font-size: 5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-light), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 20px 0
        }

        .results-grade {
            font-size: 2rem;
            margin-bottom: 10px
        }

        .results-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0
        }

        .result-stat {
            padding: 20px;
            background: var(--bg-input);
            border-radius: var(--radius-sm)
        }

        .result-stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-light)
        }

        .result-stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 5px
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px
        }

        .history-table th,
        .history-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border)
        }

        .history-table th {
            color: var(--text-muted);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px
        }

        .history-table tr:hover td {
            background: var(--bg-hover)
        }

        .badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600
        }

        .badge-success {
            background: rgba(0, 200, 83, 0.2);
            color: var(--success)
        }

        .badge-warning {
            background: rgba(255, 160, 0, 0.2);
            color: var(--warning)
        }

        .badge-error {
            background: rgba(255, 71, 87, 0.2);
            color: var(--error)
        }

        .screen {
            display: none
        }

        .screen.active {
            display: block
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0
        }

        .category-card {
            padding: 25px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            text-align: center;
            transition: all 0.2s;
            cursor: pointer
        }

        .category-card:hover {
            border-color: var(--primary);
            transform: translateY(-3px)
        }

        .category-card h3 {
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 1rem
        }

        .category-card span {
            color: var(--text-muted);
            font-size: 0.85rem
        }

        .mode-selector {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0
        }

        .mode-btn {
            flex: 1;
            max-width: 250px;
            padding: 25px;
            background: var(--bg-input);
            border: 2px solid var(--border);
            border-radius: var(--radius);
            text-align: center;
            cursor: pointer;
            transition: all 0.2s
        }

        .mode-btn:hover {
            border-color: var(--primary)
        }

        .mode-btn.selected {
            border-color: var(--accent);
            background: rgba(0, 183, 195, 0.1)
        }

        .mode-btn h3 {
            color: var(--text-primary);
            margin-bottom: 5px
        }

        .mode-btn p {
            color: var(--text-muted);
            font-size: 0.85rem
        }

        .streak-indicator {
            position: fixed;
            top: 80px;
            right: 20px;
            padding: 15px 25px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            z-index: 100;
            display: none
        }

        .streak-indicator.active {
            display: block;
            animation: slideIn 0.3s ease
        }

        @keyframes slideIn {
            from {
                transform: translateX(100px);
                opacity: 0
            }

            to {
                transform: translateX(0);
                opacity: 1
            }
        }

        .streak-fire {
            font-size: 1.5rem;
            margin-right: 10px
        }

        .streak-count {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--warning)
        }

        .combo-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 30px 50px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: var(--radius);
            z-index: 200;
            display: none;
            text-align: center
        }

        .combo-popup.active {
            display: block;
            animation: popIn 0.5s ease
        }

        @keyframes popIn {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0
            }

            50% {
                transform: translate(-50%, -50%) scale(1.1)
            }

            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1
            }
        }

        .combo-text {
            font-size: 2rem;
            font-weight: 700;
            color: white
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50
        }

        .tooltip {
            position: relative
        }

        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s
        }

        .tooltip:hover::after {
            opacity: 1
        }

        @media(max-width:768px) {
            .header h1 {
                font-size: 2rem
            }

            .stats-bar {
                grid-template-columns: repeat(2, 1fr)
            }

            .tf-grid {
                grid-template-columns: 1fr
            }

            .match-container {
                grid-template-columns: 1fr
            }

            .results-stats {
                grid-template-columns: 1fr
            }

            .timer-display {
                font-size: 2.5rem
            }

            .question-text {
                font-size: 1.2rem
            }
        }

        .shake {
            animation: shake 0.5s ease
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0)
            }

            25% {
                transform: translateX(-10px)
            }

            75% {
                transform: translateX(10px)
            }
        }

        .celebrate {
            animation: celebrate 0.6s ease
        }

        @keyframes celebrate {
            0% {
                transform: scale(1)
            }

            50% {
                transform: scale(1.05)
            }

            100% {
                transform: scale(1)
            }
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            padding: 40px
        }

        .loading-dot {
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out both
        }

        .loading-dot:nth-child(1) {
            animation-delay: -0.32s
        }

        .loading-dot:nth-child(2) {
            animation-delay: -0.16s
        }

        @keyframes bounce {

            0%,
            80%,
            100% {
                transform: scale(0)
            }

            40% {
                transform: scale(1)
            }
        }

        .review-item {
            padding: 20px;
            background: var(--bg-input);
            border-radius: var(--radius-sm);
            margin-bottom: 15px;
            border-left: 4px solid var(--border)
        }

        .review-item.review-correct {
            border-left-color: var(--success)
        }

        .review-item.review-incorrect {
            border-left-color: var(--error)
        }

        .review-question {
            font-weight: 600;
            margin-bottom: 10px
        }

        .review-answer {
            color: var(--text-secondary);
            font-size: 0.95rem
        }

        .hot-key {
            display: inline-block;
            padding: 3px 8px;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-left: 8px
        }

        #installBtn {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0, 120, 212, 0.4);
            cursor: pointer;
            transition: transform 0.2s;
            align-items: center;
            gap: 8px;
        }

        #installBtn:hover {
            transform: scale(1.05);
        }

        #brainrotLink {
            display: none;
            margin-top: 15px;
            background: linear-gradient(90deg, #ff00ff, #00ff00);
            color: #000;
            font-weight: 900;
            border: 2px solid #fff;
            box-shadow: 0 0 15px #ff00ff;
            animation: glitch 1s infinite;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 5px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        @keyframes glitch {
            0% {
                transform: translate(0)
            }

            20% {
                transform: translate(-2px, 2px)
            }

            40% {
                transform: translate(-2px, -2px)
            }

            60% {
                transform: translate(2px, 2px)
            }

            80% {
                transform: translate(2px, -2px)
            }

            100% {
                transform: translate(0)
            }
        }
    </style>
</head>

<body>

    <body>
        <button id="installBtn">
            <span>‚¨áÔ∏è</span> Install App
        </button>
        <div class="glow-line"></div>
        <div class="streak-indicator" id="streakIndicator">
            <span class="streak-fire">üî•</span>
            <span class="streak-count" id="streakCount">0</span>
            <span style="color:var(--text-muted);margin-left:5px">STREAK</span>
        </div>
        <div class="combo-popup" id="comboPopup">
            <div class="combo-text" id="comboText"></div>
        </div>
        <div class="particles" id="particles"></div>

        <div class="container">
            <!-- HOME SCREEN -->
            <div class="screen active" id="homeScreen">
                <div class="header">
                    <h1>‚õìÔ∏è BLOCKCHAIN MASTERY</h1>
                    <p>Speedrun your way to exam excellence</p>
                    <a id="brainrotLink" href="brainrot-runner-v1/gamified.html">Gamified version!!</a>
                </div>

                <div class="stats-bar">
                    <div class="stat-card">
                        <div class="stat-value" id="totalRuns">0</div>
                        <div class="stat-label">Total Runs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bestScore">0%</div>
                        <div class="stat-label">Best Score</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgScore">0%</div>
                        <div class="stat-label">Average</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bestStreak">0</div>
                        <div class="stat-label">Best Streak</div>
                    </div>
                </div>

                <div class="card">
                    <h2 style="margin-bottom:20px;color:var(--text-primary)">Select Mode</h2>
                    <div class="mode-selector">
                        <div class="mode-btn selected" data-mode="speedrun" onclick="selectMode('speedrun')">
                            <h3>‚ö° Speedrun</h3>
                            <p>All 120 questions, timed challenge</p>
                        </div>
                        <div class="mode-btn" data-mode="practice" onclick="selectMode('practice')">
                            <h3>üìö Practice</h3>
                            <p>By category, no pressure</p>
                        </div>
                        <div class="mode-btn" data-mode="blitz" onclick="selectMode('blitz')">
                            <h3>üéØ Blitz</h3>
                            <p>30 random questions, fast-paced</p>
                        </div>
                    </div>

                    <div id="categorySelector" style="display:none">
                        <h3 style="margin:30px 0 15px;color:var(--text-secondary)">Choose Category</h3>
                        <div class="category-grid" id="categoryGrid"></div>
                    </div>

                    <div style="text-align:center;margin-top:30px">
                        <button class="btn btn-primary btn-lg" onclick="startQuiz()">
                            START CHALLENGE
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h2 style="margin-bottom:20px;color:var(--text-primary)">Run History</h2>
                    <div id="historyContainer">
                        <p style="color:var(--text-muted);text-align:center;padding:20px">No runs yet. Start your first
                            challenge!</p>
                    </div>
                </div>
            </div>

            <!-- QUIZ SCREEN -->
            <div class="screen" id="quizScreen">
                <div class="card" style="margin-top:20px">
                    <div class="timer-display" id="timer">00:00</div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar" style="width:0%"></div>
                    </div>
                    <div class="progress-text">
                        <span id="currentQ">1</span> / <span id="totalQ">120</span> Questions
                        <span style="margin-left:20px">Score: <strong id="liveScore">0</strong></span>
                    </div>
                </div>

                <div class="card question-container" id="questionContainer">
                    <!-- Question content renders here -->
                </div>

                <div class="card" style="padding:15px">
                    <div style="display:flex;justify-content:space-between;align-items:center">
                        <button class="btn btn-secondary" onclick="skipQuestion()">
                            Skip <span class="hot-key">S</span>
                        </button>
                        <button class="btn btn-primary" id="submitBtn" onclick="submitAnswer()" disabled>
                            Submit <span class="hot-key">Enter</span>
                        </button>
                        <button class="btn btn-secondary" id="nextBtn" onclick="nextQuestion()" style="display:none">
                            Next <span class="hot-key">‚Üí</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- RESULTS SCREEN -->
            <div class="screen" id="resultsScreen">
                <div class="card results-container">
                    <h2 style="color:var(--text-secondary)">Challenge Complete!</h2>
                    <div class="results-score" id="finalScore">0%</div>
                    <div class="results-grade" id="finalGrade">-</div>

                    <div class="results-stats">
                        <div class="result-stat">
                            <div class="result-stat-value" id="correctCount">0</div>
                            <div class="result-stat-label">Correct</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value" id="incorrectCount">0</div>
                            <div class="result-stat-label">Incorrect</div>
                        </div>
                        <div class="result-stat">
                            <div class="result-stat-value" id="finalTime">00:00</div>
                            <div class="result-stat-label">Time</div>
                        </div>
                    </div>

                    <div style="margin-top:30px">
                        <button class="btn btn-primary" onclick="showReview()">Review Answers</button>
                        <button class="btn btn-secondary" onclick="goHome()" style="margin-left:10px">Back to
                            Home</button>
                    </div>
                </div>

                <div class="card" id="reviewContainer" style="display:none">
                    <h3 style="margin-bottom:20px">Answer Review</h3>
                    <div id="reviewContent"></div>
                </div>
            </div>
        </div>

        <script>
            const questionBank = [
                // INTRODUCTION TO BLOCKCHAIN (1-15)
                { id: 1, category: "Introduction to Blockchain", type: "mcq", question: "What is blockchain technology fundamentally described as?", options: ["A centralized database managed by banks", "A decentralized, distributed ledger technology", "A cloud storage service", "A type of cryptocurrency"], correct: 1, explanation: "Blockchain is a decentralized, distributed ledger technology that records transactions across multiple nodes." },
                { id: 2, category: "Introduction to Blockchain", type: "multi", question: "Which are core principles of blockchain? (Select all that apply)", options: ["Decentralization", "Central authority control", "Cryptographic security", "Consensus mechanisms", "Single point of storage"], correct: [0, 2, 3], explanation: "Core principles include decentralization, cryptographic security, and consensus mechanisms." },
                { id: 3, category: "Introduction to Blockchain", type: "tf", question: "Blockchain was introduced in 2008 as the underlying technology for Bitcoin.", correct: true, explanation: "Blockchain was introduced in 2008 by Satoshi Nakamoto as the underlying technology for Bitcoin." },
                { id: 4, category: "Introduction to Blockchain", type: "mcq", question: "Which of these is NOT a key component of a blockchain?", options: ["Blocks", "Nodes", "Central Server", "Consensus Mechanisms"], correct: 2, explanation: "Blockchain consists of blocks, nodes, miners, and consensus mechanisms - no central server exists." },
                { id: 5, category: "Introduction to Blockchain", type: "mcq", question: "In Proof of Work (PoW), how are transactions validated?", options: ["By voting", "By solving computational puzzles", "By random selection", "By government approval"], correct: 1, explanation: "In PoW, nodes solve computational puzzles to validate transactions." },
                { id: 6, category: "Introduction to Blockchain", type: "mcq", question: "In Proof of Stake (PoS), validators are chosen based on:", options: ["Computing power", "Random lottery", "Amount of cryptocurrency held", "Government appointment"], correct: 2, explanation: "PoS selects validators based on the amount of cryptocurrency they hold (stake)." },
                { id: 7, category: "Introduction to Blockchain", type: "tf", question: "Public blockchains restrict access to specific participants only.", correct: false, explanation: "Public blockchains are open to anyone; private blockchains restrict access." },
                { id: 8, category: "Introduction to Blockchain", type: "mcq", question: "What characteristic distinguishes blockchain from traditional databases?", options: ["Blockchain is faster", "Blockchain data is mutable", "Blockchain is decentralized and immutable", "Blockchain requires less storage"], correct: 2, explanation: "Unlike centralized databases, blockchain is decentralized and its data is immutable." },
                { id: 9, category: "Introduction to Blockchain", type: "mcq", question: "Smart contracts are best described as:", options: ["Legal documents stored digitally", "Self-executing contracts with terms written in code", "Contracts requiring lawyer approval", "Paper contracts scanned to blockchain"], correct: 1, explanation: "Smart contracts are self-executing contracts with predefined terms written into code on the blockchain." },
                { id: 10, category: "Introduction to Blockchain", type: "multi", question: "Which sectors use blockchain beyond cryptocurrency? (Select all)", options: ["Supply chain management", "Healthcare", "Voting systems", "Finance"], correct: [0, 1, 2, 3], explanation: "Blockchain is used in supply chain, healthcare, voting, and finance sectors." },
                { id: 11, category: "Introduction to Blockchain", type: "multi", question: "What are primary challenges facing blockchain today? (Select all)", options: ["Scalability", "Energy consumption", "Regulatory issues", "Interoperability"], correct: [0, 1, 2, 3], explanation: "All listed are primary challenges facing blockchain technology." },
                { id: 12, category: "Introduction to Blockchain", type: "mcq", question: "Web 3.0 is characterized by:", options: ["Centralized platforms", "User ownership of data and decentralization", "Government-controlled internet", "Corporate data monopolies"], correct: 1, explanation: "Web 3.0 enables user ownership of data and decentralization through blockchain." },
                { id: 13, category: "Introduction to Blockchain", type: "tf", question: "DApps are decentralized applications that run on blockchain networks.", correct: true, explanation: "DApps are decentralized applications running on blockchain using smart contracts." },
                { id: 14, category: "Introduction to Blockchain", type: "mcq", question: "What does DAO stand for in blockchain context?", options: ["Digital Asset Organization", "Decentralized Autonomous Organization", "Data Access Object", "Distributed Application Output"], correct: 1, explanation: "DAO stands for Decentralized Autonomous Organization." },
                { id: 15, category: "Introduction to Blockchain", type: "tf", question: "Private blockchains offer greater decentralization than public blockchains.", correct: false, explanation: "Private blockchains sacrifice decentralization for greater control." },

                // CRYPTOGRAPHY (16-30)
                { id: 16, category: "Fundamentals of Cryptography", type: "mcq", question: "What is cryptography's primary purpose in blockchain?", options: ["Speed up transactions", "Secure information through encryption", "Reduce storage costs", "Increase block size"], correct: 1, explanation: "Cryptography secures information through encryption and decryption." },
                { id: 17, category: "Fundamentals of Cryptography", type: "mcq", question: "In public key cryptography, the public key is used for:", options: ["Authorizing sending of assets", "Receiving transactions (as address)", "Mining new blocks", "Creating smart contracts"], correct: 1, explanation: "The public key serves as an address for receiving transactions." },
                { id: 18, category: "Fundamentals of Cryptography", type: "mcq", question: "The private key in blockchain is used to:", options: ["Display account balance", "Share with other users", "Authorize sending of assets", "Verify other transactions"], correct: 2, explanation: "The private key authorizes the sending of assets." },
                { id: 19, category: "Fundamentals of Cryptography", type: "tf", question: "Hash functions can be easily reversed to obtain original data.", correct: false, explanation: "Hash functions are almost impossible to reverse-engineer." },
                { id: 20, category: "Fundamentals of Cryptography", type: "mcq", question: "What do hash functions create for transactions?", options: ["Duplicate copies", "Unique fingerprints", "Backup files", "Transaction receipts"], correct: 1, explanation: "Hash functions create unique 'fingerprints' for transactions." },
                { id: 21, category: "Fundamentals of Cryptography", type: "mcq", question: "Digital signatures in blockchain provide:", options: ["Faster transactions", "Authentication and non-repudiation", "Larger block sizes", "More storage"], correct: 1, explanation: "Digital signatures provide authentication and non-repudiation." },
                { id: 22, category: "Fundamentals of Cryptography", type: "mcq", question: "A Merkle tree organizes data to enable:", options: ["Slower verification", "Efficient and secure data verification", "Data deletion", "Central control"], correct: 1, explanation: "Merkle trees enable efficient and secure data verification." },
                { id: 23, category: "Fundamentals of Cryptography", type: "mcq", question: "What cryptographic technique does Proof of Work rely on?", options: ["Symmetric encryption", "Hash functions", "Biometric scanning", "Password verification"], correct: 1, explanation: "PoW relies on cryptographic hash functions." },
                { id: 24, category: "Fundamentals of Cryptography", type: "mcq", question: "Why is Elliptic Curve Cryptography (ECC) preferred in blockchain?", options: ["Requires more computational power", "High security with smaller key sizes", "Only works on large servers", "Government mandated"], correct: 1, explanation: "ECC provides high security with smaller key sizes, making it efficient." },
                { id: 25, category: "Fundamentals of Cryptography", type: "mcq", question: "Zero-Knowledge Proof (ZKP) enables:", options: ["Proving knowledge without revealing information", "Faster mining", "Larger transactions", "Public data exposure"], correct: 0, explanation: "ZKP allows proving knowledge without revealing the information itself." },
                { id: 26, category: "Fundamentals of Cryptography", type: "tf", question: "Any data alteration in a block changes its hash, breaking chain continuity.", correct: true, explanation: "Data alteration changes the hash, breaking the chain's continuity." },
                { id: 27, category: "Fundamentals of Cryptography", type: "mcq", question: "SHA-256 is a hashing algorithm used in:", options: ["Ethereum only", "Bitcoin", "Neither Bitcoin nor Ethereum", "Cloud storage only"], correct: 1, explanation: "SHA-256 is used in Bitcoin; Ethereum uses Keccak-256." },
                { id: 28, category: "Fundamentals of Cryptography", type: "mcq", question: "Asymmetric encryption uses:", options: ["One shared key", "A pair of public and private keys", "No keys", "Physical keys"], correct: 1, explanation: "Asymmetric encryption uses a public-private key pair." },
                { id: 29, category: "Fundamentals of Cryptography", type: "tf", question: "Digital signatures ensure data hasn't been altered during transmission.", correct: true, explanation: "Digital signatures verify authenticity and integrity of transactions." },
                { id: 30, category: "Fundamentals of Cryptography", type: "mcq", question: "Keccak-256 is the hashing algorithm used in:", options: ["Bitcoin", "Ethereum", "Neither", "Both"], correct: 1, explanation: "Keccak-256 is used in Ethereum." },

                // CONSENSUS MECHANISMS (31-50)
                { id: 31, category: "Consensus Mechanisms", type: "mcq", question: "What is the primary purpose of consensus mechanisms?", options: ["Speed up internet", "Reach agreement on transaction validity", "Reduce electricity usage", "Create new cryptocurrencies"], correct: 1, explanation: "Consensus mechanisms allow networks to agree on transaction validity." },
                { id: 32, category: "Consensus Mechanisms", type: "multi", question: "What are cons of Proof of Work? (Select all)", options: ["High energy consumption", "Slower transactions", "Limited scalability", "Low security"], correct: [0, 1, 2], explanation: "PoW has high energy consumption, slower transactions, and limited scalability but is highly secure." },
                { id: 33, category: "Consensus Mechanisms", type: "mcq", question: "PoS is more energy-efficient than PoW because:", options: ["It uses solar power", "No computational puzzles needed", "It runs on fewer computers", "Government subsidies"], correct: 1, explanation: "PoS doesn't require solving computational puzzles." },
                { id: 34, category: "Consensus Mechanisms", type: "mcq", question: "In Delegated Proof of Stake (DPoS), who validates transactions?", options: ["All network participants", "Government agencies", "Voted delegates", "Random computers"], correct: 2, explanation: "In DPoS, stakeholders vote for delegates to validate transactions." },
                { id: 35, category: "Consensus Mechanisms", type: "tf", question: "DPoS improves scalability and speed but may reduce decentralization.", correct: true, explanation: "DPoS relies on fewer validators, potentially reducing decentralization." },
                { id: 36, category: "Consensus Mechanisms", type: "mcq", question: "Synchronous consensus assumes:", options: ["Network delays", "Instant communication between nodes", "No communication", "Weekly updates"], correct: 1, explanation: "Synchronous consensus assumes instant communication." },
                { id: 37, category: "Consensus Mechanisms", type: "mcq", question: "Byzantine Fault Tolerance allows networks to:", options: ["Never have faults", "Reach consensus despite malicious nodes", "Require 100% honest nodes", "Shut down when attacks occur"], correct: 1, explanation: "BFT allows consensus despite some malicious or faulty nodes." },
                { id: 38, category: "Consensus Mechanisms", type: "mcq", question: "PBFT is best suited for:", options: ["Public blockchains", "Private blockchains with known participants", "Cryptocurrency mining", "Social media"], correct: 1, explanation: "PBFT is efficient for private blockchains with known participants." },
                { id: 39, category: "Consensus Mechanisms", type: "multi", question: "Which platforms use Federated Byzantine Agreement? (Select all)", options: ["Stellar", "Ripple", "Bitcoin", "Ethereum"], correct: [0, 1], explanation: "FBA is used by Stellar and Ripple." },
                { id: 40, category: "Consensus Mechanisms", type: "mcq", question: "Hybrid PoW/PoS combines:", options: ["Two different blockchains", "PoW for mining and PoS for validation", "Cloud and local storage", "Old and new protocols"], correct: 1, explanation: "Hybrid uses PoW for mining and PoS for block validation." },
                { id: 41, category: "Consensus Mechanisms", type: "multi", question: "Criticisms of PoS include: (Select all)", options: ["Wealth centralization", "Security challenges with misaligned incentives", "Too much decentralization", "Excessive energy use"], correct: [0, 1], explanation: "PoS can lead to wealth centralization and security challenges." },
                { id: 42, category: "Consensus Mechanisms", type: "mcq", question: "What incentivizes honest behavior from PoS validators?", options: ["Government monitoring", "Risk of losing staked assets", "Social pressure", "No incentive exists"], correct: 1, explanation: "Validators risk losing assets if they act maliciously." },
                { id: 43, category: "Consensus Mechanisms", type: "multi", question: "Main security risks in consensus mechanisms include: (Select all)", options: ["51% attacks", "Sybil attacks", "Centralization risks", "Password sharing"], correct: [0, 1, 2], explanation: "51% attacks, Sybil attacks, and centralization are main risks." },
                { id: 44, category: "Consensus Mechanisms", type: "tf", question: "PoW limits scalability due to high computational demands.", correct: true, explanation: "PoW's computational demands limit scalability." },
                { id: 45, category: "Consensus Mechanisms", type: "mcq", question: "Which mechanisms offer faster processing for scalability?", options: ["Only PoW", "PoS and DPoS", "Only mining-based", "None of them"], correct: 1, explanation: "PoS and DPoS offer faster processing and scalability." },
                { id: 46, category: "Consensus Mechanisms", type: "tf", question: "Once a block is validated by consensus, it can be easily altered.", correct: false, explanation: "Validated blocks cannot be altered without network agreement." },
                { id: 47, category: "Consensus Mechanisms", type: "mcq", question: "Proof of Authority (PoA) tends to:", options: ["Maximize decentralization", "Centralize control for efficiency", "Eliminate all validators", "Use random selection only"], correct: 1, explanation: "PoA centralizes control, balancing efficiency and governance." },
                { id: 48, category: "Consensus Mechanisms", type: "mcq", question: "A 51% attack occurs when:", options: ["51 nodes join the network", "An attacker controls majority of network power", "51 transactions fail", "Block size exceeds 51MB"], correct: 1, explanation: "51% attack happens when an attacker controls majority computing/staking power." },
                { id: 49, category: "Consensus Mechanisms", type: "tf", question: "Asynchronous consensus works better under network delays.", correct: true, explanation: "Asynchronous consensus offers better fault tolerance under delays." },
                { id: 50, category: "Consensus Mechanisms", type: "mcq", question: "What does FBA stand for?", options: ["Fast Block Addition", "Federated Byzantine Agreement", "Final Block Approval", "Forward Blockchain Algorithm"], correct: 1, explanation: "FBA stands for Federated Byzantine Agreement." },

                // BLOCKCHAIN ARCHITECTURE (51-75)
                { id: 51, category: "Blockchain Architecture", type: "multi", question: "Main components of blockchain architecture include: (Select all)", options: ["Nodes", "Blocks", "Consensus mechanisms", "Cryptographic protocols"], correct: [0, 1, 2, 3], explanation: "All listed are main components of blockchain architecture." },
                { id: 52, category: "Blockchain Architecture", type: "mcq", question: "Nodes in blockchain are responsible for:", options: ["Only creating blocks", "Storing, validating, and transmitting data", "Destroying old records", "Connecting to government servers"], correct: 1, explanation: "Nodes store, validate, and transmit data." },
                { id: 53, category: "Blockchain Architecture", type: "multi", question: "Each block contains: (Select all)", options: ["List of transactions", "Timestamp", "Hash of previous block", "Nonce"], correct: [0, 1, 2, 3], explanation: "Blocks contain transactions, timestamp, previous hash, and nonce." },
                { id: 54, category: "Blockchain Architecture", type: "mcq", question: "The Genesis Block is:", options: ["The last block in chain", "The first block in a blockchain", "A backup block", "A deleted block"], correct: 1, explanation: "Genesis Block is the first block in a blockchain." },
                { id: 55, category: "Blockchain Architecture", type: "tf", question: "Bitcoin's Genesis Block was mined on January 3, 2009.", correct: true, explanation: "Satoshi Nakamoto mined Bitcoin's Genesis Block on January 3, 2009." },
                { id: 56, category: "Blockchain Architecture", type: "mcq", question: "Blockchain achieves immutability through:", options: ["Government regulations", "Cryptographic hashing and linked structure", "Manual verification", "Cloud backups"], correct: 1, explanation: "Immutability is achieved through hashing and linked block structure." },
                { id: 57, category: "Blockchain Architecture", type: "mcq", question: "P2P network in blockchain:", options: ["Requires central servers", "Allows direct node communication", "Only works locally", "Needs government approval"], correct: 1, explanation: "P2P allows nodes to communicate directly without central servers." },
                { id: 58, category: "Blockchain Architecture", type: "tf", question: "Permissioned blockchains require approval to join.", correct: true, explanation: "Permissioned blockchains require approval; permissionless are open." },
                { id: 59, category: "Blockchain Architecture", type: "mcq", question: "Layer 2 solutions help with:", options: ["Mining efficiency", "Off-chain transactions for scalability", "Data deletion", "Centralization"], correct: 1, explanation: "Layer 2 handles off-chain transactions to improve scalability." },
                { id: 60, category: "Blockchain Architecture", type: "mcq", question: "The ledger in blockchain provides:", options: ["Temporary storage", "Transparent, immutable transaction record", "Editable history", "Private-only access"], correct: 1, explanation: "The ledger provides transparent, immutable records." },
                { id: 61, category: "Blockchain Architecture", type: "mcq", question: "What is a nonce used for in PoW?", options: ["User authentication", "Meeting difficulty requirements for block creation", "Storing transaction data", "Network communication"], correct: 1, explanation: "Nonce is used in PoW to meet difficulty requirements." },
                { id: 62, category: "Blockchain Architecture", type: "multi", question: "DApps leverage blockchain for: (Select all)", options: ["Transparency", "Security", "Decentralization", "Central control"], correct: [0, 1, 2], explanation: "DApps use transparency, security, and decentralization of blockchain." },
                { id: 63, category: "Blockchain Architecture", type: "mcq", question: "Sharding improves scalability by:", options: ["Increasing block size", "Dividing blockchain into parallel shards", "Removing old blocks", "Adding more miners"], correct: 1, explanation: "Sharding divides blockchain into smaller parts for parallel processing." },
                { id: 64, category: "Blockchain Architecture", type: "tf", question: "Larger block sizes can slow down network speed.", correct: true, explanation: "Larger blocks hold more data but may slow network speed." },
                { id: 65, category: "Blockchain Architecture", type: "mcq", question: "Zero-knowledge proofs in architecture help with:", options: ["Speed only", "Enhanced privacy and confidentiality", "Block creation", "Mining efficiency"], correct: 1, explanation: "ZKPs provide enhanced confidentiality in blockchain architecture." },
                { id: 66, category: "Blockchain Architecture", type: "mcq", question: "A hard fork creates:", options: ["Temporary pause", "Permanent blockchain divergence", "Faster transactions", "Smaller blocks"], correct: 1, explanation: "Hard forks create permanent divergence in the blockchain." },
                { id: 67, category: "Blockchain Architecture", type: "tf", question: "Soft forks are backward-compatible updates.", correct: true, explanation: "Soft forks maintain backward compatibility." },
                { id: 68, category: "Blockchain Architecture", type: "mcq", question: "Block 0 is also known as:", options: ["Origin Block", "Genesis Block", "Prime Block", "Alpha Block"], correct: 1, explanation: "Block 0 is called the Genesis Block." },
                { id: 69, category: "Blockchain Architecture", type: "mcq", question: "Block rewards consist of:", options: ["Only transaction fees", "Only new cryptocurrency", "New cryptocurrency and transaction fees", "Government payments"], correct: 2, explanation: "Block rewards include newly minted cryptocurrency and transaction fees." },
                { id: 70, category: "Blockchain Architecture", type: "tf", question: "Bitcoin's initial block reward was 50 BTC.", correct: true, explanation: "Bitcoin's initial block reward was 50 BTC, halving every ~4 years." },
                { id: 71, category: "Blockchain Architecture", type: "mcq", question: "Difficulty in mining refers to:", options: ["User interface complexity", "Computational challenge to add new blocks", "Network connection issues", "Storage requirements"], correct: 1, explanation: "Difficulty is the computational challenge for adding new blocks." },
                { id: 72, category: "Blockchain Architecture", type: "tf", question: "Bitcoin's difficulty adjusts approximately every two weeks.", correct: true, explanation: "Bitcoin difficulty adjusts every ~2 weeks to maintain 10-minute block time." },
                { id: 73, category: "Blockchain Architecture", type: "mcq", question: "Higher mining difficulty results in:", options: ["Faster block creation", "Slower block creation with enhanced security", "Lower security", "No change"], correct: 1, explanation: "Higher difficulty slows block creation but enhances security." },
                { id: 74, category: "Blockchain Architecture", type: "mcq", question: "A hierarchical hash structure for efficient verification is called:", options: ["Hash Table", "Merkle Tree", "Binary Search", "Hash Map"], correct: 1, explanation: "Merkle tree is a hierarchical hash structure for verification." },
                { id: 75, category: "Blockchain Architecture", type: "tf", question: "Each block in blockchain includes the hash of its predecessor.", correct: true, explanation: "Each block contains the previous block's hash, creating an immutable chain." },

                // NODES (76-95)
                { id: 76, category: "Nodes in Blockchain", type: "mcq", question: "What is a node in blockchain context?", options: ["A mining rig only", "Any device participating in the network", "The central server", "A type of cryptocurrency"], correct: 1, explanation: "A node is any device participating in a blockchain network." },
                { id: 77, category: "Nodes in Blockchain", type: "multi", question: "Types of nodes in blockchain include: (Select all)", options: ["Full nodes", "Light nodes", "Archive nodes", "Central nodes"], correct: [0, 1, 2], explanation: "Blockchain has full, light, and archive nodes - no central nodes." },
                { id: 78, category: "Nodes in Blockchain", type: "mcq", question: "Full nodes maintain:", options: ["Only block headers", "Complete copy of blockchain ledger", "Partial transaction history", "No data"], correct: 1, explanation: "Full nodes maintain a complete copy of the blockchain ledger." },
                { id: 79, category: "Nodes in Blockchain", type: "mcq", question: "Light nodes are also called:", options: ["Heavy nodes", "SPV nodes", "Master nodes", "Relay nodes"], correct: 1, explanation: "Light nodes are called SPV (Simplified Payment Verification) nodes." },
                { id: 80, category: "Nodes in Blockchain", type: "tf", question: "Light nodes store only block headers.", correct: true, explanation: "Light nodes store only headers, relying on full nodes for data." },
                { id: 81, category: "Nodes in Blockchain", type: "mcq", question: "Archive nodes:", options: ["Delete old data", "Preserve entire blockchain history including pruned data", "Only store recent blocks", "Don't exist"], correct: 1, explanation: "Archive nodes preserve the entire blockchain history." },
                { id: 82, category: "Nodes in Blockchain", type: "mcq", question: "Miner nodes in PoW:", options: ["Only verify transactions", "Solve cryptographic puzzles to add blocks", "Don't participate in consensus", "Store data only"], correct: 1, explanation: "Miner nodes solve puzzles to add new blocks in PoW." },
                { id: 83, category: "Nodes in Blockchain", type: "tf", question: "Decentralization is achieved because nodes are distributed globally.", correct: true, explanation: "Global node distribution ensures no single point of failure." },
                { id: 84, category: "Nodes in Blockchain", type: "mcq", question: "Validator nodes in PoS:", options: ["Mine using computational power", "Validate based on their stake", "Have no special role", "Only relay transactions"], correct: 1, explanation: "PoS validators validate and propose blocks based on their stake." },
                { id: 85, category: "Nodes in Blockchain", type: "mcq", question: "Master nodes perform:", options: ["Basic validation only", "Additional tasks like privacy transactions and governance", "No special functions", "Only mining"], correct: 1, explanation: "Master nodes perform additional tasks and earn rewards." },
                { id: 86, category: "Nodes in Blockchain", type: "tf", question: "Master nodes typically require collateral to operate.", correct: true, explanation: "Master nodes usually require collateral to operate." },
                { id: 87, category: "Nodes in Blockchain", type: "mcq", question: "Nodes contribute to security by:", options: ["Storing redundant ledger copies", "Validating transactions", "Using consensus mechanisms", "All of the above"], correct: 3, explanation: "Nodes secure blockchain through storage, validation, and consensus." },
                { id: 88, category: "Nodes in Blockchain", type: "mcq", question: "A node synchronizes by:", options: ["Downloading from central server", "Downloading ledger from other nodes from genesis block", "Random data collection", "Manual upload"], correct: 1, explanation: "Nodes sync by downloading from other nodes starting from genesis block." },
                { id: 89, category: "Nodes in Blockchain", type: "multi", question: "Challenges nodes face include: (Select all)", options: ["High storage requirements", "Bandwidth consumption", "Computational demands", "Energy costs"], correct: [0, 1, 2, 3], explanation: "All listed are challenges nodes face." },
                { id: 90, category: "Nodes in Blockchain", type: "mcq", question: "During forks, nodes follow:", options: ["The shortest chain", "The longest valid chain", "Random selection", "Central authority decision"], correct: 1, explanation: "Nodes follow the longest valid chain or most accumulated work/stake." },
                { id: 91, category: "Nodes in Blockchain", type: "mcq", question: "Relay nodes:", options: ["Validate all transactions", "Facilitate transaction and block propagation", "Store the entire ledger", "Create new blocks"], correct: 1, explanation: "Relay nodes facilitate propagation across the network." },
                { id: 92, category: "Nodes in Blockchain", type: "tf", question: "High node participation may limit scalability.", correct: true, explanation: "High participation enhances security but may limit scalability." },
                { id: 93, category: "Nodes in Blockchain", type: "mcq", question: "Full nodes ensure network integrity by:", options: ["Creating new cryptocurrencies", "Verifying transactions adhere to consensus protocol", "Connecting to banks", "Storing passwords"], correct: 1, explanation: "Full nodes verify that transactions and blocks adhere to protocol." },
                { id: 94, category: "Nodes in Blockchain", type: "mcq", question: "P2P communication among nodes ensures:", options: ["Centralized control", "Decentralized and robust network", "Government oversight", "Single point of failure"], correct: 1, explanation: "P2P ensures decentralized, robust network without central servers." },
                { id: 95, category: "Nodes in Blockchain", type: "tf", question: "Light nodes can interact with blockchain without downloading entire ledger.", correct: true, explanation: "Light nodes provide faster access without full ledger download." },

                // SMART CONTRACTS (96-105)
                { id: 96, category: "Smart Contracts", type: "mcq", question: "A smart contract differs from traditional contracts by:", options: ["Requiring more lawyers", "Self-executing with terms in code", "Being paper-based", "Needing court approval"], correct: 1, explanation: "Smart contracts are self-executing with terms written in code." },
                { id: 97, category: "Smart Contracts", type: "multi", question: "Key components of smart contracts include: (Select all)", options: ["Code (logic and rules)", "Blockchain storage", "Distributed ledger", "Physical signatures"], correct: [0, 1, 2], explanation: "Smart contracts have code, blockchain storage, and distributed ledger." },
                { id: 98, category: "Smart Contracts", type: "tf", question: "Smart contracts eliminate intermediaries by automatically enforcing terms.", correct: true, explanation: "Smart contracts automatically enforce agreements without intermediaries." },
                { id: 99, category: "Smart Contracts", type: "mcq", question: "Which platform is most widely used for smart contracts?", options: ["Bitcoin", "Ethereum", "Facebook", "Google Cloud"], correct: 1, explanation: "Ethereum is most widely used due to its robust developer ecosystem." },
                { id: 100, category: "Smart Contracts", type: "mcq", question: "Solidity is a programming language for smart contracts on:", options: ["Bitcoin", "Ethereum", "Ripple", "Traditional databases"], correct: 1, explanation: "Solidity is used to write smart contracts on Ethereum." },
                { id: 101, category: "Smart Contracts", type: "multi", question: "Advantages of smart contracts include: (Select all)", options: ["Automation", "Speed", "Cost efficiency", "Transparency"], correct: [0, 1, 2, 3], explanation: "All listed are advantages of smart contracts." },
                { id: 102, category: "Smart Contracts", type: "tf", question: "Smart contracts require trusted intermediaries to function.", correct: false, explanation: "Smart contracts reduce/eliminate the need for intermediaries." },
                { id: 103, category: "Smart Contracts", type: "multi", question: "Platforms for creating smart contracts include: (Select all)", options: ["Ethereum", "Hyperledger Fabric", "Polkadot", "Binance Smart Chain"], correct: [0, 1, 2, 3], explanation: "All listed are platforms for smart contract development." },
                { id: 104, category: "Smart Contracts", type: "mcq", question: "Smart contracts ensure trust through:", options: ["Government backing", "Immutable and publicly verifiable code", "Bank guarantees", "Insurance policies"], correct: 1, explanation: "Trust comes from immutable, publicly verifiable code on blockchain." },
                { id: 105, category: "Smart Contracts", type: "tf", question: "Smart contract code and transaction history are publicly verifiable.", correct: true, explanation: "Code and history are immutable and publicly verifiable." },

                // PRIVACY & SECURITY (106-115)
                { id: 106, category: "Privacy and Security", type: "mcq", question: "Security in blockchain focuses on:", options: ["User interface design", "Protecting from unauthorized access and tampering", "Marketing strategies", "Speed optimization"], correct: 1, explanation: "Security protects against unauthorized access, attacks, and tampering." },
                { id: 107, category: "Privacy and Security", type: "mcq", question: "Privacy in blockchain focuses on:", options: ["Transaction speed", "Protecting user identities and transaction details", "Block size", "Mining efficiency"], correct: 1, explanation: "Privacy protects identities and transaction details from being traced." },
                { id: 108, category: "Privacy and Security", type: "tf", question: "Blockchain addresses are pseudonymous, not anonymous.", correct: true, explanation: "Addresses are pseudonymous; analysis can de-anonymize users." },
                { id: 109, category: "Privacy and Security", type: "mcq", question: "Address clustering and transaction linking can:", options: ["Speed up transactions", "De-anonymize users", "Create new blocks", "Reduce fees"], correct: 1, explanation: "These analyses can de-anonymize users from public ledger data." },
                { id: 110, category: "Privacy and Security", type: "tf", question: "Modifying blockchain data is computationally infeasible in large networks.", correct: true, explanation: "Recomputing the entire chain is computationally infeasible." },
                { id: 111, category: "Privacy and Security", type: "mcq", question: "Digital signatures ensure:", options: ["Faster mining", "Non-repudiation, authorization, and integrity", "Larger blocks", "Lower fees"], correct: 1, explanation: "Digital signatures ensure non-repudiation, authorization, and integrity." },
                { id: 112, category: "Privacy and Security", type: "multi", question: "Privacy risks from blockchain transparency include: (Select all)", options: ["Transaction linking", "Address clustering", "Financial profiling", "Surveillance"], correct: [0, 1, 2, 3], explanation: "All listed are privacy risks from blockchain transparency." },
                { id: 113, category: "Privacy and Security", type: "mcq", question: "Hashing ensures data integrity by:", options: ["Encrypting user passwords", "Creating fixed-length digests that change with any modification", "Storing data in cloud", "Compressing files"], correct: 1, explanation: "Small data modifications produce drastically different hashes." },
                { id: 114, category: "Privacy and Security", type: "tf", question: "Users sign transactions using their public key.", correct: false, explanation: "Users sign with private key; validation uses public key." },
                { id: 115, category: "Privacy and Security", type: "mcq", question: "If an attacker modifies a block, what happens?", options: ["Nothing changes", "All later hashes become invalid", "Transaction speeds increase", "Rewards double"], correct: 1, explanation: "Modification invalidates all subsequent hashes." },

                // FUTURE TRENDS (116-125)
                { id: 116, category: "Future Trends", type: "mcq", question: "Blockchain can enhance digital identities by providing:", options: ["Centralized control", "Secure, tamper-proof, decentralized identity", "Government databases", "Social media profiles"], correct: 1, explanation: "Blockchain enables secure, tamper-proof, decentralized digital identities." },
                { id: 117, category: "Future Trends", type: "multi", question: "Scalability solutions include: (Select all)", options: ["Sharding", "Layer-2 solutions", "Proof of Stake", "Lightning Network"], correct: [0, 1, 2, 3], explanation: "All listed are scalability solutions for blockchain." },
                { id: 118, category: "Future Trends", type: "mcq", question: "In the Metaverse, blockchain enables:", options: ["Only gaming", "Decentralized ownership and virtual economies", "Physical product delivery", "Traditional banking"], correct: 1, explanation: "Blockchain powers decentralized ownership and virtual economies." },
                { id: 119, category: "Future Trends", type: "multi", question: "Blockchain applications in sustainability include: (Select all)", options: ["Energy management", "Carbon credit tracking", "Renewable energy incentives", "Tokenized reward systems"], correct: [0, 1, 2, 3], explanation: "All listed are blockchain applications in green technology." },
                { id: 120, category: "Future Trends", type: "mcq", question: "Quantum computing could potentially:", options: ["Make blockchain faster", "Break current cryptographic algorithms", "Reduce energy consumption", "Eliminate mining"], correct: 1, explanation: "Quantum computing could break current cryptographic algorithms." },
                { id: 121, category: "Future Trends", type: "mcq", question: "To counter quantum threats, blockchain is developing:", options: ["Faster processors", "Quantum-resistant cryptographic protocols", "More miners", "Larger blocks"], correct: 1, explanation: "Quantum-resistant protocols are being developed for security." },
                { id: 122, category: "Future Trends", type: "tf", question: "NFTs are digital assets secured by blockchain.", correct: true, explanation: "NFTs are secured and verified on blockchain." },
                { id: 123, category: "Future Trends", type: "mcq", question: "Self-sovereign identity means:", options: ["Government controls all data", "Users control their own personal data", "Companies own user data", "No identity verification"], correct: 1, explanation: "Self-sovereign identity empowers users to control their data." },
                { id: 124, category: "Future Trends", type: "mcq", question: "Blockchain's role in IoT includes:", options: ["Only data storage", "Decentralized storage, device authentication, smart contract automation", "Physical device manufacturing", "Internet speed boost"], correct: 1, explanation: "Blockchain secures IoT with storage, authentication, and automation." },
                { id: 125, category: "Future Trends", type: "tf", question: "Blockchain can improve supply chain transparency and traceability.", correct: true, explanation: "Blockchain enables tracking goods from origin to delivery." },

                // EMERGING TECHNOLOGIES (126-130)
                { id: 126, category: "Emerging Technologies", type: "mcq", question: "Blockchain enhances AI by ensuring:", options: ["Faster processing only", "Data integrity, traceability, and secure sharing", "More GPUs", "Lower costs"], correct: 1, explanation: "Blockchain enhances AI with data integrity, traceability, and secure sharing." },
                { id: 127, category: "Emerging Technologies", type: "mcq", question: "AI can optimize blockchain through:", options: ["Physical mining", "Consensus mechanisms and predictive analytics", "Paper documentation", "Manual verification"], correct: 1, explanation: "AI can optimize consensus mechanisms and predictive analytics." },
                { id: 128, category: "Emerging Technologies", type: "tf", question: "dApps rely on centralized servers.", correct: false, explanation: "dApps run on decentralized blockchain without centralized servers." },
                { id: 129, category: "Emerging Technologies", type: "mcq", question: "Blockchain provides infrastructure for dApps that is:", options: ["Centralized and controlled", "Trustless, secure, and transparent", "Expensive and slow", "Government regulated"], correct: 1, explanation: "Blockchain provides trustless, secure, transparent infrastructure for dApps." },
                { id: 130, category: "Emerging Technologies", type: "multi", question: "Blockchain and AI relationship includes: (Select all)", options: ["AI optimizes blockchain operations", "Blockchain ensures AI data integrity", "Secure data sharing", "Predictive analytics"], correct: [0, 1, 2, 3], explanation: "Both technologies complement each other in multiple ways." }
            ];

            const categories = [...new Set(questionBank.map(q => q.category))];
            let currentMode = 'speedrun';
            let selectedCategory = null;
            let currentQuestions = [];
            let currentIndex = 0;
            let score = 0;
            let streak = 0;
            let maxStreak = 0;
            let timer = null;
            let seconds = 0;
            let answers = [];
            let selectedOptions = [];
            let matchSelections = { left: null, right: null };
            let matchedPairs = [];
            let orderItems = [];
            let fillBlanks = {};
            let isAnswered = false;

            function init() {
                loadProgress();
                renderCategories();
                updateStats();
                loadHistory();
                setupKeyboardShortcuts();
            }

            function loadProgress() {
                const saved = localStorage.getItem('blockchainMastery');
                if (saved) {
                    const data = JSON.parse(saved);
                    return data;
                }
                return { runs: [], bestScore: 0, bestStreak: 0 };
            }

            function saveProgress(runData) {
                const data = loadProgress();
                data.runs.push(runData);
                if (runData.score > data.bestScore) data.bestScore = runData.score;
                if (runData.maxStreak > data.bestStreak) data.bestStreak = runData.maxStreak;
                localStorage.setItem('blockchainMastery', JSON.stringify(data));
            }

            function updateStats() {
                const data = loadProgress();
                document.getElementById('totalRuns').textContent = data.runs.length;
                document.getElementById('bestScore').textContent = data.bestScore + '%';
                document.getElementById('bestStreak').textContent = data.bestStreak;

                if (data.runs.length > 0) {
                    const avg = Math.round(data.runs.reduce((a, b) => a + b.score, 0) / data.runs.length);
                    document.getElementById('avgScore').textContent = avg + '%';
                }

                if (localStorage.getItem('brainrotUnlocked') === 'true') {
                    document.getElementById('brainrotLink').style.display = 'inline-block';
                }
            }

            function loadHistory() {
                const data = loadProgress();
                const container = document.getElementById('historyContainer');

                if (data.runs.length === 0) {
                    container.innerHTML = '<p style="color:var(--text-muted);text-align:center;padding:20px">No runs yet. Start your first challenge!</p>';
                    return;
                }

                const recentRuns = data.runs.slice(-10).reverse();
                let html = '<table class="history-table"><thead><tr><th>Date</th><th>Mode</th><th>Score</th><th>Time</th><th>Grade</th></tr></thead><tbody>';

                recentRuns.forEach(run => {
                    const grade = getGrade(run.score);
                    const badgeClass = run.score >= 87 ? 'badge-success' : run.score >= 70 ? 'badge-warning' : 'badge-error';
                    html += `<tr>
            <td>${new Date(run.date).toLocaleDateString()}</td>
            <td style="text-transform:capitalize">${run.mode}</td>
            <td><strong>${run.score}%</strong></td>
            <td>${formatTime(run.time)}</td>
            <td><span class="badge ${badgeClass}">${grade}</span></td>
        </tr>`;
                });

                html += '</tbody></table>';
                container.innerHTML = html;
            }

            function renderCategories() {
                const grid = document.getElementById('categoryGrid');
                grid.innerHTML = categories.map(cat => {
                    const count = questionBank.filter(q => q.category === cat).length;
                    return `<div class="category-card" onclick="selectCategory('${cat}')">
            <h3>${cat}</h3>
            <span>${count} questions</span>
        </div>`;
                }).join('');
            }

            function selectMode(mode) {
                currentMode = mode;
                document.querySelectorAll('.mode-btn').forEach(btn => {
                    btn.classList.toggle('selected', btn.dataset.mode === mode);
                });
                document.getElementById('categorySelector').style.display = mode === 'practice' ? 'block' : 'none';
            }

            function selectCategory(cat) {
                selectedCategory = cat;
                document.querySelectorAll('.category-card').forEach(card => {
                    card.style.borderColor = card.querySelector('h3').textContent === cat ? 'var(--accent)' : 'var(--border)';
                    card.style.background = card.querySelector('h3').textContent === cat ? 'rgba(0,183,195,0.1)' : 'var(--bg-input)';
                });
            }

            function shuffleArray(array) {
                const arr = [...array];
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            function startQuiz() {
                if (currentMode === 'practice' && !selectedCategory) {
                    alert('Please select a category first!');
                    return;
                }

                switch (currentMode) {
                    case 'speedrun':
                        currentQuestions = shuffleArray(questionBank);
                        break;
                    case 'practice':
                        currentQuestions = shuffleArray(questionBank.filter(q => q.category === selectedCategory));
                        break;
                    case 'blitz':
                        currentQuestions = shuffleArray(questionBank).slice(0, 30);
                        break;
                }

                currentIndex = 0;
                score = 0;
                streak = 0;
                maxStreak = 0;
                seconds = 0;
                answers = [];

                document.getElementById('totalQ').textContent = currentQuestions.length;

                showScreen('quizScreen');
                startTimer();
                renderQuestion();
            }

            function startTimer() {
                timer = setInterval(() => {
                    seconds++;
                    const display = document.getElementById('timer');
                    display.textContent = formatTime(seconds);

                    if (currentMode === 'blitz') {
                        if (seconds > 180) display.classList.add('danger');
                        else if (seconds > 120) display.classList.add('warning');
                    } else if (currentMode === 'speedrun') {
                        if (seconds > 3000) display.classList.add('danger');
                        else if (seconds > 2400) display.classList.add('warning');
                    }
                }, 1000);
            }

            function formatTime(secs) {
                const m = Math.floor(secs / 60);
                const s = secs % 60;
                return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            }

            function renderQuestion() {
                const q = currentQuestions[currentIndex];
                const container = document.getElementById('questionContainer');

                selectedOptions = [];
                matchSelections = { left: null, right: null };
                matchedPairs = [];
                fillBlanks = {};
                isAnswered = false;

                document.getElementById('submitBtn').style.display = 'inline-flex';
                document.getElementById('submitBtn').disabled = true;
                document.getElementById('nextBtn').style.display = 'none';

                document.getElementById('currentQ').textContent = currentIndex + 1;
                document.getElementById('liveScore').textContent = score;

                const progress = ((currentIndex) / currentQuestions.length) * 100;
                document.getElementById('progressBar').style.width = progress + '%';

                let html = `
        <div class="question-header">
            <span class="question-number">Question ${currentIndex + 1} of ${currentQuestions.length}</span>
            <span class="question-category">${q.category}</span>
        </div>
        <div class="question-type">${getQuestionTypeLabel(q.type)}</div>
        <div class="question-text">${q.question}</div>
    `;

                switch (q.type) {
                    case 'mcq':
                        html += renderMCQ(q);
                        break;
                    case 'multi':
                        html += renderMulti(q);
                        break;
                    case 'tf':
                        html += renderTF(q);
                        break;
                }

                html += '<div class="feedback" id="feedback"></div>';
                container.innerHTML = html;
                container.classList.remove('shake', 'celebrate');
                void container.offsetWidth;
            }

            function getQuestionTypeLabel(type) {
                const labels = {
                    'mcq': 'üìù Single Choice',
                    'multi': '‚òëÔ∏è Multiple Choice (Select All That Apply)',
                    'tf': '‚úì‚úó True or False'
                };
                return labels[type] || type;
            }

            function renderMCQ(q) {
                const letters = ['A', 'B', 'C', 'D', 'E', 'F'];
                const shuffledOptions = q.options.map((opt, idx) => ({ text: opt, originalIndex: idx }));

                return `<div class="options-grid">
        ${shuffledOptions.map((opt, idx) => `
            <div class="option" onclick="selectMCQ(${idx}, ${opt.originalIndex})" data-idx="${idx}" data-original="${opt.originalIndex}">
                <span class="option-marker">${letters[idx]}</span>
                <span class="option-text">${opt.text}</span>
            </div>
        `).join('')}
    </div>`;
            }

            function renderMulti(q) {
                const letters = ['A', 'B', 'C', 'D', 'E', 'F'];
                return `<div class="options-grid multi-select">
        ${q.options.map((opt, idx) => `
            <div class="option" onclick="selectMulti(${idx})" data-idx="${idx}">
                <span class="option-marker">${letters[idx]}</span>
                <span class="option-text">${opt}</span>
            </div>
        `).join('')}
    </div>`;
            }

            function renderTF(q) {
                return `<div class="tf-grid">
        <div class="option tf-option" onclick="selectTF(true)" data-value="true">
            <span class="option-marker">‚úì</span>
            <span class="option-text">TRUE</span>
        </div>
        <div class="option tf-option" onclick="selectTF(false)" data-value="false">
            <span class="option-marker">‚úó</span>
            <span class="option-text">FALSE</span>
        </div>
    </div>`;
            }

            function selectMCQ(displayIdx, originalIdx) {
                if (isAnswered) return;

                document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                document.querySelector(`.option[data-idx="${displayIdx}"]`).classList.add('selected');
                selectedOptions = [originalIdx];
                document.getElementById('submitBtn').disabled = false;
            }

            function selectMulti(idx) {
                if (isAnswered) return;

                const option = document.querySelector(`.option[data-idx="${idx}"]`);
                option.classList.toggle('selected');

                if (selectedOptions.includes(idx)) {
                    selectedOptions = selectedOptions.filter(i => i !== idx);
                } else {
                    selectedOptions.push(idx);
                }

                document.getElementById('submitBtn').disabled = selectedOptions.length === 0;
            }

            function selectTF(value) {
                if (isAnswered) return;

                document.querySelectorAll('.tf-option').forEach(opt => opt.classList.remove('selected'));
                document.querySelector(`.tf-option[data-value="${value}"]`).classList.add('selected');
                selectedOptions = [value];
                document.getElementById('submitBtn').disabled = false;
            }

            function submitAnswer() {
                if (isAnswered || selectedOptions.length === 0) return;

                isAnswered = true;
                const q = currentQuestions[currentIndex];
                let isCorrect = false;

                switch (q.type) {
                    case 'mcq':
                        isCorrect = selectedOptions[0] === q.correct;
                        showMCQFeedback(q.correct);
                        break;
                    case 'multi':
                        const sortedSelected = [...selectedOptions].sort();
                        const sortedCorrect = [...q.correct].sort();
                        isCorrect = JSON.stringify(sortedSelected) === JSON.stringify(sortedCorrect);
                        showMultiFeedback(q.correct);
                        break;
                    case 'tf':
                        isCorrect = selectedOptions[0] === q.correct;
                        showTFFeedback(q.correct);
                        break;
                }

                answers.push({
                    question: q.question,
                    correct: isCorrect,
                    userAnswer: selectedOptions,
                    correctAnswer: q.correct,
                    explanation: q.explanation
                });

                const feedback = document.getElementById('feedback');
                const container = document.getElementById('questionContainer');

                if (isCorrect) {
                    score++;
                    streak++;
                    if (streak > maxStreak) maxStreak = streak;

                    feedback.className = 'feedback correct';
                    feedback.innerHTML = `<span class="feedback-icon">‚úì</span> Correct! ${q.explanation}`;
                    container.classList.add('celebrate');

                    updateStreak();
                    checkCombo();
                } else {
                    streak = 0;
                    feedback.className = 'feedback incorrect';
                    feedback.innerHTML = `<span class="feedback-icon">‚úó</span> Incorrect. ${q.explanation}`;
                    container.classList.add('shake');
                    hideStreak();
                }

                document.getElementById('liveScore').textContent = score;
                document.getElementById('submitBtn').style.display = 'none';
                document.getElementById('nextBtn').style.display = 'inline-flex';
            }

            function showMCQFeedback(correctIdx) {
                document.querySelectorAll('.option').forEach(opt => {
                    const origIdx = parseInt(opt.dataset.original);
                    if (origIdx === correctIdx) {
                        opt.classList.add('correct');
                    } else if (opt.classList.contains('selected')) {
                        opt.classList.add('incorrect');
                    }
                });
            }

            function showMultiFeedback(correctIdxs) {
                document.querySelectorAll('.option').forEach(opt => {
                    const idx = parseInt(opt.dataset.idx);
                    if (correctIdxs.includes(idx)) {
                        opt.classList.add('correct');
                    } else if (opt.classList.contains('selected')) {
                        opt.classList.add('incorrect');
                    }
                });
            }

            function showTFFeedback(correctVal) {
                document.querySelectorAll('.tf-option').forEach(opt => {
                    const val = opt.dataset.value === 'true';
                    if (val === correctVal) {
                        opt.classList.add('correct');
                    } else if (opt.classList.contains('selected')) {
                        opt.classList.add('incorrect');
                    }
                });
            }

            function updateStreak() {
                if (streak >= 3) {
                    document.getElementById('streakIndicator').classList.add('active');
                    document.getElementById('streakCount').textContent = streak;
                }

                // UNLOCK BRAINROT MODE
                if (streak >= 50 && currentMode !== 'practice') {
                    const btn = document.getElementById('brainrotLink');
                    if (btn.style.display !== 'inline-block') {
                        btn.style.display = 'inline-block';
                        localStorage.setItem('brainrotUnlocked', 'true');
                        alert("Gamified Version Unlocked! üéÆ");
                    }
                }
            }

            function hideStreak() {
                document.getElementById('streakIndicator').classList.remove('active');
            }

            function checkCombo() {
                const combos = {
                    5: 'üî• ON FIRE!',
                    10: '‚ö° UNSTOPPABLE!',
                    15: 'üíé LEGENDARY!',
                    20: 'üèÜ GODLIKE!',
                    25: 'üåü TRANSCENDENT!'
                };

                if (combos[streak]) {
                    showComboPopup(combos[streak]);
                    createParticles();
                }
            }

            function showComboPopup(text) {
                const popup = document.getElementById('comboPopup');
                document.getElementById('comboText').textContent = text;
                popup.classList.add('active');

                setTimeout(() => {
                    popup.classList.remove('active');
                }, 1500);
            }

            function createParticles() {
                const container = document.getElementById('particles');
                const colors = ['#0078d4', '#00b7c3', '#00c853', '#ffa000', '#ff4757'];

                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement('div');
                    particle.style.cssText = `
            position: absolute;
            width: 10px;
            height: 10px;
            background: ${colors[Math.floor(Math.random() * colors.length)]};
            border-radius: 50%;
            left: ${50 + (Math.random() - 0.5) * 20}%;
            top: 50%;
            pointer-events: none;
            animation: particleFly ${0.5 + Math.random() * 0.5}s ease-out forwards;
        `;
                    container.appendChild(particle);

                    setTimeout(() => particle.remove(), 1000);
                }
            }

            const style = document.createElement('style');
            style.textContent = `
    @keyframes particleFly {
        0% { transform: translate(0, 0) scale(1); opacity: 1; }
        100% { transform: translate(${Math.random() * 200 - 100}px, ${Math.random() * 200 - 100}px) scale(0); opacity: 0; }
    }
`;
            document.head.appendChild(style);

            function nextQuestion() {
                currentIndex++;

                if (currentIndex >= currentQuestions.length) {
                    endQuiz();
                } else {
                    renderQuestion();
                }
            }

            function skipQuestion() {
                if (isAnswered) return;

                answers.push({
                    question: currentQuestions[currentIndex].question,
                    correct: false,
                    userAnswer: null,
                    correctAnswer: currentQuestions[currentIndex].correct,
                    explanation: currentQuestions[currentIndex].explanation,
                    skipped: true
                });

                streak = 0;
                hideStreak();
                nextQuestion();
            }

            function endQuiz() {
                clearInterval(timer);

                const percentage = Math.round((score / currentQuestions.length) * 100);
                const grade = getGrade(percentage);

                const runData = {
                    date: new Date().toISOString(),
                    mode: currentMode,
                    category: selectedCategory,
                    score: percentage,
                    correct: score,
                    total: currentQuestions.length,
                    time: seconds,
                    maxStreak: maxStreak
                };

                saveProgress(runData);

                document.getElementById('finalScore').textContent = percentage + '%';
                document.getElementById('finalGrade').textContent = grade;
                document.getElementById('correctCount').textContent = score;
                document.getElementById('incorrectCount').textContent = currentQuestions.length - score;
                document.getElementById('finalTime').textContent = formatTime(seconds);

                hideStreak();
                showScreen('resultsScreen');

                if (percentage >= 87) {
                    celebrateSuccess();
                }
            }

            function getGrade(percentage) {
                if (percentage >= 97) return 'A+';
                if (percentage >= 93) return 'A';
                if (percentage >= 90) return 'A-';
                if (percentage >= 87) return 'B+';
                if (percentage >= 83) return 'B';
                if (percentage >= 80) return 'B-';
                if (percentage >= 77) return 'C+';
                if (percentage >= 73) return 'C';
                if (percentage >= 70) return 'C-';
                if (percentage >= 67) return 'D+';
                if (percentage >= 63) return 'D';
                if (percentage >= 60) return 'D-';
                return 'F';
            }

            function celebrateSuccess() {
                for (let i = 0; i < 5; i++) {
                    setTimeout(createParticles, i * 300);
                }
            }

            function showReview() {
                const container = document.getElementById('reviewContainer');
                const content = document.getElementById('reviewContent');

                container.style.display = 'block';

                content.innerHTML = answers.map((a, idx) => `
        <div class="review-item ${a.correct ? 'review-correct' : 'review-incorrect'}">
            <div class="review-question">${idx + 1}. ${a.question}</div>
            <div class="review-answer">
                ${a.skipped ? '<em>Skipped</em>' : `Your answer: ${formatAnswer(a.userAnswer)}`}
                <br>
                Correct answer: ${formatAnswer(a.correctAnswer)}
                <br>
                <small style="color:var(--text-muted)">${a.explanation}</small>
            </div>
        </div>
    `).join('');

                container.scrollIntoView({ behavior: 'smooth' });
            }

            function formatAnswer(answer) {
                if (answer === null) return 'N/A';
                if (typeof answer === 'boolean') return answer ? 'True' : 'False';
                if (Array.isArray(answer)) return answer.map(a => typeof a === 'number' ? String.fromCharCode(65 + a) : a).join(', ');
                if (typeof answer === 'number') return String.fromCharCode(65 + answer);
                return answer;
            }

            function goHome() {
                document.getElementById('reviewContainer').style.display = 'none';
                showScreen('homeScreen');
                updateStats();
                loadHistory();
            }

            function showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.getElementById(screenId).classList.add('active');
            }

            function setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (document.getElementById('quizScreen').classList.contains('active')) {
                        if (e.key === 'Enter' && !document.getElementById('submitBtn').disabled && !isAnswered) {
                            submitAnswer();
                        } else if (e.key === 'Enter' && isAnswered) {
                            nextQuestion();
                        } else if (e.key === 'ArrowRight' && isAnswered) {
                            nextQuestion();
                        } else if (e.key.toLowerCase() === 's' && !isAnswered) {
                            skipQuestion();
                        } else if (['1', '2', '3', '4', 'a', 'b', 'c', 'd'].includes(e.key.toLowerCase()) && !isAnswered) {
                            const q = currentQuestions[currentIndex];
                            let idx;
                            if (['1', '2', '3', '4'].includes(e.key)) {
                                idx = parseInt(e.key) - 1;
                            } else {
                                idx = e.key.toLowerCase().charCodeAt(0) - 97;
                            }

                            if (q.type === 'mcq') {
                                const opt = document.querySelector(`.option[data-idx="${idx}"]`);
                                if (opt) opt.click();
                            } else if (q.type === 'multi') {
                                const opt = document.querySelector(`.option[data-idx="${idx}"]`);
                                if (opt) opt.click();
                            } else if (q.type === 'tf' && idx < 2) {
                                const val = idx === 0 ? 'true' : 'false';
                                const opt = document.querySelector(`.tf-option[data-value="${val}"]`);
                                if (opt) opt.click();
                            }
                        }
                    }
                });
            }

            // Initialize on load
            document.addEventListener('DOMContentLoaded', init);
        </script>
        <script>
            // Service Worker Registration
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('./sw.js')
                        .then(reg => console.log('Service Worker registered', reg))
                        .catch(err => console.log('Service Worker registration failed', err));
                });
            }

            // Install Button Logic
            let deferredPrompt;
            const installBtn = document.getElementById('installBtn');

            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                installBtn.style.display = 'flex';
            });

            installBtn.addEventListener('click', async () => {
                if (!deferredPrompt) return;
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`User response to the install prompt: ${outcome}`);
                deferredPrompt = null;
                installBtn.style.display = 'none';
            });

            window.addEventListener('appinstalled', () => {
                installBtn.style.display = 'none';
                deferredPrompt = null;
                console.log('PWA was installed');
            });
        </script>
    </body>

</html>